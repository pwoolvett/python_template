[tox]
envlist = black, blacktest, unit, badging, docs,
skipsdist = True
skip_install = True

[testenv]
envdir = {toxinidir}/.venv
basepython = python3.6
deps = pipenv
commands =
    pipenv install --dev --ignore-pipfile


[testenv:env]
recreate = False
description = "Install basic dependencies for working application, without running tests"


[testenv:black]
description = "reformat code"

commands =
    black --py36 babel_tower

[testenv:blacktest]
description = "reformat testing code"

commands =
    black --py36 tests

[testenv:unit]
description = "Run unit tests"

commands =
    pytest {posargs} -v --tb=short -ra --cov=babel_tower tests/unit

[testenv:integration]
description = "Run integration tests"

commands =
    docker-compose
    pytest {posargs} -v --tb=short -ra --cov=babel_tower tests/integration
    tests/integration/teardown_compose.sh

[testenv:docs]
description = "invoke sphinx-build to build the HTML docs"
commands =
    sphinx-build \
    -d "{toxinidir}/docs/build/.doctrees" \
    "{toxinidir}/docs/source" \
    "{toxinidir}/docs/build" \
    --color \
    -E \
    -a \
;    -W \
    -bhtml
